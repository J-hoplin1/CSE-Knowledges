네트워크 이론-2장 : 데이터 링크 계층
===
***

- 데이터 링크 계층의 역할

    - 데이터 링크 계층의 역할은 **네트워크 장비간에 신호를 주고받는 '규칙'을 정하는 계층** 이다. 그리고 이 규칙에서 가장 많이 사용되는것이 바로 '이더넷(Ethernet)이다.


- **허브**에서 여러대가 동시에 데이터를 보내게 되면, 데이터간 '충돌'이 일어나게 된다.

    - 이더넷은 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 일어나지 않는 구조이다.

    - 충돌 방지를 위해 CSMA/CD 라는 방법을 이용하는데, 이는 데이터 보내는 시점을 늦추는것이다.

        1. CS(Carrier Sense) : 데이터를 보내려는 PC,케이블에 신호가 흐르는지 확인
        
        2. MA(Multiple Access) : 흐르지 않으면 데이터 보내는것 가능하다.

        3. CD(Collision Domain) : 충돌하는지 확인한다.
    
    - 하지만 위 CSMA/CD방법은 효율성이 매우 떨어지는 방법이다. 우리가 스위치를 사용하는 이유중 하나도 이 효율적이지 못한 CSMA/CD를 대체하기 위해서다.

- MAC 주소

    - 랜카드에는 **MAC 주소** 번호가 정해져 있다.

        - MAC주소는 제조될때 새겨지기에 **'물리주소'**라고도 부른다.

        - MAC주소는 전세계 유일한 번호로 할당된다.(중복이 불가능하다는 소리)

        - MAC주소 구조는 다음과 같다.

            ~~~
                (제조사 번호 : 24bit) + (제조사에서 붙인 번호 : 24bit)
            ~~~
        
        - 즉 MAC주소는 총 48bit, 6바이트로 구성된다.

- 데아터 링크 계층의 헤더

    - [앞의 내용](https://github.com/J-hoplin1/CSE-Knowledges/blob/main/Network%20Theory/0%20.%20%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0.md)에서 봤듯이, 각 계층에서는 '헤더'라는 필요한 데이터를 붙이는것이 있다고 하였다.

    - 데이터 링크 계층에서는 데이터에 **'이더넷 헤더'** 와 **'트레일러'**를 붙인다.

        - 이더넷 헤더의 구성

            ~~~
                (목적지 MAC주소 : 6byte) + (출발지 MAC주소 : 6byte) + (유형 : 2byte)

                유형은 이더넷으로 전송되는 상위 계층 프로토콜에 대한 식별번호라고 보면된다.(예를들면 IPv4,IPv6등..)
            ~~~
        
            - [유형의 종류들](https://m.blog.naver.com/PostView.nhn?blogId=sujunghan726&logNo=220315439853&proxyReferer=https:%2F%2Fwww.google.com%2F)
        
        - 트레일러

            - FCS(Frame Check Sequence)라고도 부른다. 이는 전송중 오류가 발생하였는지 확인하기 위해 사용이 된다.

    - 이더넷 헤더, 트레일러가 추가된 데이터를 **'프레임(Frame)'** 이라고 부른다.

    - 물리계층은 이 '프레임'을 랜카드를 통해 전기신호로 변환하는 역할을 하는 것이다.

- 스위치(Switch)

    - 스위치의 특징
    
        - 스위치는 데이터링크 계층에서 작동한다.

        - 데이터링크 계층에서 작동하기에 Layer2Switch라고 부르기도 한다.

    - 스위치의 MAC주소 테이블

        - 물리계층 설명에서도 봤듯이, 허브는 특정 포트로만 보낼려고 해도 모든 포트로 데이터를 전송한다. 하지만 이는 보안적인거에도 문제가 될 수 있고, 사생활적인면에서도 문제가 될 수 있다.

        - 스위치는 이 단점을 보완하기 위해 데이터를 보낼때 목적지를 명시하고 보내는데 이 목적지가 바로 'MAC주소'였다.

        - 스위치 내부에는 MAC주소 테이블이라는 것이 있다. MAC주소 테이블이란 스위치 포트번호와 해당포트에 연결된 컴퓨터 MAC주소가 등록되는 데이터베이스를 의미한다.

    - MAC주소 학습기능

        - 스위치를 처음 실행했을때 MAC주소 테이블 안에 포트별로 MAC주소가 모두 작성되어있을까? 아니다. 처음에는 이 MAC주소 테이블은 당연히 비어있다.

        - 스위치는 데이터를 처음 전송하고 MAC주소 테이블에 해당 포트와 전송한 컴퓨터의 MAC주소를 함께 저장해 두는데 이 과정을 'MAC주소 학습기능'이라고 한다.
    
        - 이를 기반으로 두가지의 스위치 데이터 전송을 해석할 수 있다.

            1. MAC주소 테이블에 목적지 MAC주소가 없는 경우

                - 플러딩(flooding)현상이 발생한다. 그 후 MAC주소 학습기능을 통해 등록이 된다.

                - 플러딩이란 목적지 MAC주소가 등록되지 않아 모든 포트로 데이터가 전송되는 현상을 의미한다.
            
            2. MAC주소 테이블에 목적지 MAC주소가 있는 경우

                - 보내려는 포트로 등록된 PC에만 전달이 된다.

                - 이 경우와 같이 MAC주소 기준으로 목적지를 선택하는 것을 'MAC주소 필터링'이라고 한다.

- 전이중 통신방식과 반이중 통신방식

    - 통신방식에 크게 두가지가 있다.

        1. 전이중 통신방식

            - 말 그대로 데이터 송신과 수신이 동시에 이루어지는것이다.

        2. 반이중 통신방식

            - 회선 하나를 이용해 송신 수신이 번갈아 가면서 이루어지는 것이다.
    
    - 허브는 송수신이 나누어져있지 않기 때문에 '반이중통신'방식을 사용한다.(CSMA/CD가 바로 반이중 통신이다.)

    - 반대로 스위치는 송신 수신이 충돌하지 않는 구조로 되어있기 때문에 '전이중통신'방식을 사용한다.

    - 스위치가 송신 수신 충돌이 일어나지 않는 이유는 MAC주소 필터링 기법과 버퍼링 기법이 있기에 충돌이 일어나지 않는다.

- 충돌 도메인

    - 송신 수신간 충돌 발생시 그 영향이 미치는 범위를 의미한다.

    - 스위치, 허브별로 각각의 충돌 도메인을 비교하자.

        - 허브

            1. 반이중 통신이다.

            2. 반이중 통신이기에 선로 하나로 송신 수신을 번갈아가며 시행한다.

            3. 결론적으로 충돌 발생시 해당 허브에 연결된 모든 PC가 충돌 도메인이 된다.
        
        - 스위치

            1. 전이중 통신이다.

            2. 결론적으로 송신 수신이 동시에 실행되기에 충돌이 발생하지 않는다.

            3. 충돌 도메인은 충돌이 일어난 그 PC만 해당이 된다.
